<!DOCTYPE html>
<html>
<head>
	<title>Casey Spain's Assign09</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="final-project.css"/>
    <script type="text/javascript">
    function loadCollection() {
        const resultList = document.getElementById('divResults');
        resultList.innerHTML = '';
        for (var i = 0; i < localStorage.length; i++){
            var key = localStorage.key(i);
            loadItem(localStorage[key]);
        }
    }

    function loadItem(name) {
        var url = 'https://www.omdbapi.com/?i=tt3896198&apikey=5797b0b&s=' + name;
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
	    	if (this.readyState == 4 && this.status == 200) {
                var data = this.response;
                parsed = JSON.parse(data);
                console.log(JSON.parse(data));
                updateResultList(parsed);
            }
        };
    }

    function updateResultList(data) {
        if (data.Search && data.Search.length > 0) {
            const resultList = document.getElementById('divResults');
            resultList.innerHTML = '';
            data.Search.forEach(function(item){
                const title = item.Title;
                console.log(item);
                if(item.Poster != 'N/A'){
                    const poster = item.Poster;
                    const content2 = `<img onclick='searchItem("${title}");' class='thumbnail moveUp' src='${poster}' alt='${title}'/>`;
                    resultList.innerHTML += content2;
                }
            })
        }
    }
    
    </script>
</head>

<body onload="loadCollection();">
	<script>
    </script>
<div class="topnav">
    <a href="final-project.html">Home</a>
    <a class="active" href="#home">Collection</a>
</div>
<div class="header">
    <br>
    <br>
    <h1>Your Movie Collection</h1>
    <br><br>
</div>

<div class="divResults" id="divResults">
</div>

</body>
</html>