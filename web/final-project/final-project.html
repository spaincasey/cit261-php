<!DOCTYPE html>
<html>
<head>
	<title>Casey Spain's Assign09</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Bootstrap CSS -->
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
    <link rel="stylesheet" type="text/css" href="local_storage.css"/>
  </head>
</head>
<body onload="createCSS()">
	<script>

    var it = 0;
    var table = "<table>";
        function search() {
        // Get the value from the search box
        var searchString = document.getElementById('txtSearch').value;
        console.log('Searching for: ' + searchString);

        // Set up the parameters to send to the API
        var params =
            '?apikey=5797b0b&s=' + encodeURIComponent(searchString);
        var url = 'http://www.omdbapi.com/' + params;

        //call fetch with our url...remember that fetch returns a Promise
        //that must be processed with a call to the .then() method.
        xhttp.onreadystatechange = function() {
	    	if (this.readyState == 4 && this.status == 200) {
                var data = this.response;
                // console.log(data);
                console.log(JSON.parse(this.responseText));
            }
	  	};
        xhttp.open("GET", url, true);
        xhttp.send();
        // fetch(url)
        //     .then(function(response) {
        //     // fetch also returns a stream as the result...we have to tell it
        //     // how to format the stream...our choices are: json, text, or blob (binary data)
        //     return response.json();
        //     // the json() method also returns a promise...so we need
        //     //to call .then() on it as well (shown on the next line)
        // })
        // .then(function(data) {
        //     // we now have our data and can use it to update our page.
        //     updateResultList(data);
        // });
    }

    function updateResultList(data) {
    console.log('UpdateResultList');
    console.log(data);

    if (data.Search && data.Search.length > 0) {
        const resultList = document.getElementById('ulResults');
        resultList.innerHTML = '';

        // you could use a forEach here as well...it would change the following line like this:
        // data.Search.forEach(function(item){ ...process each item here })
        for (let i = 0; i < data.Search.length; i++) {
        const title = data.Search[i].Title;

        console.log('Adding: ' + title);
        const content = `<li><p>${title}</p></li>`;
        resultList.innerHTML += content;
        }
    }
    }


    function ajaxRequest() {
        url = 'https://api.github.com/users';
        var xhttp = new XMLHttpRequest();
	  	xhttp.onreadystatechange = function() {
	    	if (this.readyState == 4 && this.status == 200) {
                var data = this.response;
                // console.log(data);
                console.log(JSON.parse(this.responseText));
            }
	  	};
        xhttp.open("GET", url, true);
        xhttp.send();
    }

    function build(data, j, keys){
    }

    function addFavorite(index) {
    }
    </script>
<div class="topnav">
    <a class="active" href="#home">Home</a>
    <a href="favorites.html">Favorites</a>
</div>
<h1>Movie Search (Fetch)</h1>

<p>Please enter a movie title to search:</p>
<input type="text" id="txtSearch">
<button onclick="search();">Search</button>

<div id="divResults">
    <h2>Results</h2>
    <ul id="ulResults">
    </ul>
</div>

<div class="header">
    <br>
    <br>
    <h1>Star Wars API Loader</h1>
    <br><br>
</div>
<div class="center" id="demo">
  	<br>
  	<h3>Pick a Category</h3>
  	<!-- <textarea id="display" rows="10" cols="80"></textarea>
	<br> -->
  	<select id="Country">
  		<option value="people" selected>People</option>
		<option value="planets">Planets</option>
        <option value="species">Species</option>
        <option value="starships">Starships</option>
        <option value="vehicles">Vehicles</option>
	</select>
      <button type="button" onclick="loadDoc()">Change Content</button>
    <div class="display2">
    </div>
    <div id="result" class="display">
    </div>
    <div id="result2" class="display">
    </div>
</div>
</body>
</html>