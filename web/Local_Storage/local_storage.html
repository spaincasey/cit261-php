<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="local_storage.css"/>
	<title>Casey Spain's Assign09</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script>
	function loadDoc() {
		var country = document.getElementById("Country").value;
	  	var xhttp = new XMLHttpRequest();
	  	xhttp.onreadystatechange = function() {
	    	if (this.readyState == 4 && this.status == 200) {
                var data = this.response;
                build(data);
	     		// document.getElementById("display").innerHTML = this.responseText;
	    	}
	  	};
	  	switch(country) {
	  	case "people":
	  		xhttp.open("GET", "https://swapi.co/api/people/", true);
	  		xhttp.send();
	  		break;
	  	case "planets":
	  		xhttp.open("GET", "https://swapi.co/api/planets/", true);
	  		xhttp.send();
	  		break;
	  	case "films":
	  		xhttp.open("GET", "https://swapi.co/api/films/", true);
	  		xhttp.send();
	  		break;
	  	case "species":
	  		xhttp.open("GET", "https://swapi.co/api/species/", true);
	  		xhttp.send();
	  		break;
        case "starships":
	  		xhttp.open("GET", "https://swapi.co/api/starships/", true);
	  		xhttp.send();
	  		break;
	  	case "vehicles":
	  		xhttp.open("GET", "https://swapi.co/api/vehicles/", true);
	  		xhttp.send();
	  		break;
		}
	}

    function build(data) {
        console.log(data);
		var obj = JSON.parse(data);
        for (var key in obj.results) {
            var item = key += ": " += obj.results[key];
            console.log("Key: " + key);
            console.log("Value: " + obj.results[key]);
            document.getElementById("display").innerHTML = item;
        }
        // document.getElementById("display").innerHTML = obj;
		// var table = "<table><tr><th>First Name</th><th>Last Name</th><th>Student ID</th><th>GPA</th></tr>";
		// for(var i = 0; i < obj.students.length; i++)
		// {
		// 	table += "<tr><td>" + obj.students[i].firstName + "</td><td>" + obj.students[i].lastName + "</td><td>" + obj.students[i].studentId + "</td><td>" + obj.students[i].gpa + "</td></tr>";
		// }

		// document.getElementById("directory").innerHTML = table;
	}

	function loadJson() {
		var file = document.getElementById("jsonName").value;
		var url = "http://157.201.194.254/~cs213/" + file;
		var xmlhttp = new 	XMLHttpRequest();
		xmlhttp.onreadystatechange = function() {

			if (this.readyState == 4 && this.status == 200) {
				var myObj = JSON.parse(this.responseText);
				var list = "<table border = '1'><tr><th>Name</th><th>Address</th><th>Rank</th><th>GPA</th></tr>\n";

				for(var i = 0; i < myObj.students.length; i++)
				{
					list = list + "<tr><td>" + myObj.students[i].first + " " + myObj.students[i].last + "</td>" + 
					"<td>" + myObj.students[i].address.city +  ", " + myObj.students[i].address.state + " " + 
					myObj.students[i].address.zip + "</td>" + "<td>" + myObj.students[i].major + "</td>" + "<td>" + 
					myObj.students[i].gpa + "</td></tr>\n";
				}
				document.getElementById("table").innerHTML = list;
			}
		};
		xmlhttp.open("GET", url, true);
		xmlhttp.send();
	}
	</script>
</head>
<body>
<div class="header">
    <br><br><br>
    <h1>Local Storage</h1>
</div>
<div class="display center" id="demo">
  	<br>
  	<h3>Pick a city to see the 10 largest cities</h3>
  	<textarea id="display" rows="6" cols="40"></textarea>
	<br>
  	<select id="Country">
  		<option value="people" selected>People</option>
		<option value="planets">Planets</option>
		<option value="films">Films</option>
        <option value="species">Species</option>
        <option value="starships">Starships</option>
        <option value="vehicles">Vehicles</option>
	</select>
  	<button type="button" onclick="loadDoc()">Change Content</button>
</div>

<div class="display center">
	<p>Input a JSON file</p>
	<input type="text" id="jsonName" name="jsonName" value="json.txt"><br>
	<br>
	<button type="button" onclick="loadJson()">Change Content</button>
	<p id="table"></p>
</div>
</body>
</html>